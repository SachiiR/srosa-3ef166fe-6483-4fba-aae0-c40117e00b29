<div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6 mb-6">
  <h2 class="text-xl font-semibold mb-4 text-gray-900 dark:text-white">
    {{ isEditMode ? 'Edit Task' : 'Create New Task' }}
  </h2>

  <form #taskForm="ngForm" (ngSubmit)="onSubmit(taskForm)" class="space-y-4">
    <!-- Title -->
    <div>
      <label for="title" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
        Title <span class="text-red-500">*</span>
      </label>
      <input
        id="title"
        name="title"
        [(ngModel)]="formData.title"
        required
        [disabled]="isViewer"
        minlength="3"
        maxlength="100"
        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 disabled:opacity-50"
        placeholder="Enter task title"
      />
      <div *ngIf="taskForm.controls['title']?.invalid && taskForm.controls['title']?.touched" class="text-red-500 text-xs mt-1">
        Title is required (min 3 characters)
      </div>
    </div>

    <!-- Description -->
    <div>
      <label for="description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
        Description
      </label>
      <textarea
        id="description"
        name="description"
        [(ngModel)]="formData.description"
        rows="3"
        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500"
        placeholder="Optional task details..."
      ></textarea>
    </div>

    <!-- Category -->
    <div>
      <label for="category" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
        Category
      </label>
      <select
        id="category"
        name="category"
        [disabled]="isViewer"
        [(ngModel)]="formData.category"
        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 disabled:opacity-50"
      >
        <option value="Work">Work</option>
        <option value="Personal">Personal</option>
      </select>
    </div>

    <!-- Status -->
    <div>
      <label for="status" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
        Status
      </label>
      <select
        id="status"
        name="status"
        [(ngModel)]="formData.status"
        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
      >
        <option value="Pending">Pending</option>
        <option value="Completed">Completed</option>
      </select>
    </div>

    <!-- Assigned To -->
    <div>
      <label for="assignedToId" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
        Assign To
      </label>
      <select
        id="assignedToId"
        name="assignedToId"
        [(ngModel)]="formData.assignedToId"
        [disabled]="isViewer"
        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 disabled:opacity-50"
      >
        <option [ngValue]="null">Unassigned</option>
        <option *ngFor="let user of users" [ngValue]="user.id">
          {{ user.username }} ({{ user.role }})
        </option>
      </select>
    </div>

    <!-- Action buttons -->
    <div class="flex justify-end gap-3 pt-4">
      <button
        *ngIf="isEditMode"
        type="button"
        (click)="cancelEdit()"
        class="px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-gray-100 rounded hover:bg-gray-400 dark:hover:bg-gray-500 transition"
      >
        Cancel
      </button>

      <button
        type="submit"
        [disabled]="!isViewer && taskForm.invalid"
        class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition disabled:opacity-50 disabled:cursor-not-allowed"
      >
        {{ isEditMode ? 'Update Task' : 'Create Task' }}
      </button>
    </div>
  </form>
</div>